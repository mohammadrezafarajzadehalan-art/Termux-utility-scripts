#!/bin/bash

# =============================================
# complex_marriage_simulator.sh
# ุดุจูโุณุงุฒ ุดุฑุงุท ูพฺุฏู ุงุฒุฏูุงุฌ ููุณุงูโุง
# ุจุง ุฏุฎุชุฑ ุดุงุบูุ ุญุณุงุฏุช ููุณุงฺฏุงู ู ุชุงุฑุฎฺู ุฑุฏ ุฎูุงุณุชฺฏุงุฑุงู
# =============================================

# ุชูุธูุงุช ุดุฎุตุชโูุง
BOY_NAME="ูพุณุฑ ููุณุงู"
GIRL_NAME="ุณุงุฑุง (ุฏุฎุชุฑ ููุณุงู)"
GIRL_OCCUPATION="ูููุฏุณ ูุฑูโุงูุฒุงุฑ"
GIRL_SALARY_LEVEL=80  # ุณุทุญ ุฏุฑุขูุฏ ุฏุฎุชุฑ (0-100)
BOY_OCCUPATION="ุชุงุฒูโฺฉุงุฑ ุฏุฑ ุจุงุฒุงุฑ"
BOY_SALARY_LEVEL=35   # ุณุทุญ ุฏุฑุขูุฏ ูพุณุฑ

# ุชูุธูุงุช ุฎุงููุงุฏู ุฏุฎุชุฑ
FAMILY_THRESHOLD=85
FAMILY_ATTITUDE=30  # ูฺฏุฑุด ุฎุงููุงุฏู (ูพุงู = ุจโูู)
FAMILY_PRIDE_LEVEL=75  # ุณุทุญ ุบุฑูุฑ ุฎุงููุงุฏู

# ุชูุธูุงุช ูพุณุฑ
BOY_NEED_LEVEL=90  # ูุฒุงู ูุงุฒ ูพุณุฑ ุจู ุฏุฎุชุฑ (ุนุงุทู/ุงูุชุตุงุฏ)
BOY_SELF_ESTEEM=65  # ุนุฒุช ููุณ ูพุณุฑ
BOY_RESILIENCE=70   # ุชุงุจโุขูุฑ ูพุณุฑ

# ุชูุธูุงุช ุงุฌุชูุงุน
JEALOUS_NEIGHBORS=3  # ุชุนุฏุงุฏ ููุณุงูโูุง ุญุณูุฏ
PREVIOUS_REJECTED_SUITORS=4  # ุชุนุฏุงุฏ ุฎูุงุณุชฺฏุงุฑุงู ุฑุฏ ุดุฏู ูุจู
NEIGHBOR_INTERFERENCE_LEVEL=60  # ุณุทุญ ุฏุฎุงูุช ููุณุงฺฏุงู
SOCIAL_STATUS_DISPARITY=55  # ุงุฎุชูุงู ุฌุงฺฏุงู ุงุฌุชูุงุน (ูพุณุฑ ูพุงูโุชุฑ)

# ุชูุธูุงุช ุฑูุงู
GIRL_INDIFFERENCE=70  # ุจโูู ุฏุฎุชุฑ
FAMILY_DISDAIN=65     # ุชุญูุฑ ุฎุงููุงุฏู
REJECTION_TRAUMA=0    # ุชุฑููุงโ ุฑุฏ ุดุฏูโูุง ูุจู ุฏุฎุชุฑ

# ุฑูฺฏโูุง ูพุดุฑูุชู
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
WHITE='\033[1;37m'
ORANGE='\033[0;33m'
LIGHT_RED='\033[1;31m'
LIGHT_GREEN='\033[1;32m'
LIGHT_BLUE='\033[1;34m'
NC='\033[0m'

# ุชุงุจุน ููุงุด ูุฏุฑ
show_header() {
    clear
    echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo -e "${PURPLE}โ   ุดุจูโุณุงุฒ ูพฺุฏู ุงุฒุฏูุงุฌ ููุณุงูโุง ุจุง ุฏุฎุชุฑ ุดุงุบู        โ${NC}"
    echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo ""
}

# ุชุงุจุน ููุงุด ูุถุนุช ฺฉุงูู
show_complete_status() {
    echo -e "${WHITE}โโโโโโโโโโโโโโโโโโโโ ๐ค ูุดุฎุตุงุช ุงูุฑุงุฏ โโโโโโโโโโโโโโโโโโโโ${NC}"
    echo -e "${WHITE}โ  ูพุณุฑ: $BOY_NAME | ุดุบู: $BOY_OCCUPATION${NC}"
    echo -e "${WHITE}โ  ุฏุฎุชุฑ: $GIRL_NAME | ุดุบู: $GIRL_OCCUPATION${NC}"
    echo -e "${WHITE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo ""
    
    echo -e "${WHITE}โโโโโโโโโโโโโโโโโโโโ ๐ ูุถุนุช ุงูุชุตุงุฏ โโโโโโโโโโโโโโโโโโโ${NC}"
    echo -e "${WHITE}โ  ๐ฐ ุฏุฑุขูุฏ ูพุณุฑ: ${BOY_SALARY_LEVEL}/100${NC}"
    echo -e "${WHITE}โ  ๐ฐ ุฏุฑุขูุฏ ุฏุฎุชุฑ: ${GIRL_SALARY_LEVEL}/100${NC}"
    echo -e "${WHITE}โ  ๐ ุงุฎุชูุงู ุงูุชุตุงุฏ: $((GIRL_SALARY_LEVEL - BOY_SALARY_LEVEL)) ูุงุญุฏ${NC}"
    echo -e "${WHITE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo ""
    
    echo -e "${WHITE}โโโโโโโโโโโโโโโโโโโโ ๐ ูุถุนุช ุนุงุทู โโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo -e "${WHITE}โ  ๐ฅ ูุงุฒ ูพุณุฑ ุจู ุฏุฎุชุฑ: ${BOY_NEED_LEVEL}/100${NC}"
    echo -e "${WHITE}โ  โ ุจโูู ุฏุฎุชุฑ: ${GIRL_INDIFFERENCE}/100${NC}"
    echo -e "${WHITE}โ  ๐ ุนุฒุช ููุณ ูพุณุฑ: ${BOY_SELF_ESTEEM}/100${NC}"
    echo -e "${WHITE}โ  ๐ช ุชุงุจโุขูุฑ ูพุณุฑ: ${BOY_RESILIENCE}/100${NC}"
    echo -e "${WHITE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo ""
    
    echo -e "${WHITE}โโโโโโโโโโโโโโโโโโโโ ๐ฅ ุนูุงูู ุงุฌุชูุงุน โโโโโโโโโโโโโโโโโโโ${NC}"
    echo -e "${WHITE}โ  ๐ฟ ููุณุงูโูุง ุญุณูุฏ: $JEALOUS_NEIGHBORS ููุฑ${NC}"
    echo -e "${WHITE}โ  โ ุฎูุงุณุชฺฏุงุฑุงู ุฑุฏโุดุฏู ูุจู: $PREVIOUS_REJECTED_SUITORS ููุฑ${NC}"
    echo -e "${WHITE}โ  ๐ฏ ุณุทุญ ุฏุฎุงูุช ููุณุงฺฏุงู: ${NEIGHBOR_INTERFERENCE_LEVEL}/100${NC}"
    echo -e "${WHITE}โ  ๐ ุบุฑูุฑ ุฎุงููุงุฏู ุฏุฎุชุฑ: ${FAMILY_PRIDE_LEVEL}/100${NC}"
    echo -e "${WHITE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
}

# ุชุงุจุน ุดุจูโุณุงุฒ ุญุณุงุฏุช ููุณุงฺฏุงู
simulate_neighbor_jealousy() {
    local boy_progress=$1
    local interference_chance=$((RANDOM % 100))
    
    echo ""
    echo -e "${ORANGE}๐ฅ ูุนุงูุช ููุณุงูโูุง ุญุณูุฏ...${NC}"
    
    # ูุฑฺู ูพุดุฑูุช ูพุณุฑ ุจุดุชุฑ ุจุงุดุฏุ ุญุณุงุฏุช ููุณุงฺฏุงู ุจุดุชุฑ ูโุดูุฏ
    if [ $boy_progress -gt 40 ] && [ $interference_chance -lt $NEIGHBOR_INTERFERENCE_LEVEL ]; then
        local jealousy_level=$(( (boy_progress * NEIGHBOR_INTERFERENCE_LEVEL) / 100 ))
        
        echo -e "${LIGHT_RED}   โ ููุณุงูโูุง ุฏุฑ ุญุงู ุชุฎุฑุจ ฺูุฑู ูพุณุฑ ูุณุชูุฏ!${NC}"
        echo -e "${YELLOW}   โณ ยซุงุฏุชููู ุงู ูพุณุฑ ูุจูุงู ฺู ูุถุนุช ุฏุงุดุชุยป${NC}"
        echo -e "${YELLOW}   โณ ยซุฎุงููุงุฏู ูุญุชุฑู ูุง ูุงูุช ุจูุชุฑ ุงุฒ ุงู ุฏุงุฑูยป${NC}"
        
        # ุชุฃุซุฑ ุจุฑ ูฺฏุฑุด ุฎุงููุงุฏู
        FAMILY_ATTITUDE=$((FAMILY_ATTITUDE - (jealousy_level / 5)))
        BOY_SELF_ESTEEM=$((BOY_SELF_ESTEEM - (jealousy_level / 10)))
        
        # ุงฺฏุฑ ุฎูุงุณุชฺฏุงุฑุงู ุฑุฏุดุฏู ูุจู ูุฌูุฏ ุฏุงุฑูุฏุ ุงุฒ ุขููุง ูู ุณูุกุงุณุชูุงุฏู ูโุดูุฏ
        if [ $PREVIOUS_REJECTED_SUITORS -gt 0 ]; then
            echo -e "${RED}   ๐ ููุณุงูโูุง ุจุง ุฎูุงุณุชฺฏุงุฑุงู ุฑุฏุดุฏู ูุจู ููุฏุณุช ูโุดููุฏ!${NC}"
            echo -e "${YELLOW}   โณ ยซุงูู ุฎูุงุณุชฺฏุงุฑ ูููุฏุณ ุฑู ุงุฏุชูููุ ฺุฑุง ุงููู ุฑุฏ ฺฉุฑุฏูุยป${NC}"
            REJECTION_TRAUMA=$((REJECTION_TRAUMA + 20))
            NEIGHBOR_INTERFERENCE_LEVEL=$((NEIGHBOR_INTERFERENCE_LEVEL + 10))
        fi
        
        return 1
    fi
    
    return 0
}

# ุชุงุจุน ุดุจูโุณุงุฒ ุจโูู ุฏุฎุชุฑ ู ุฎุงููุงุฏู
simulate_indifference() {
    local boy_financial=$1
    local boy_need=$2
    
    echo ""
    echo -e "${PURPLE}๐ญ ูฺฏุฑุด ุฏุฎุชุฑ ู ุฎุงููุงุฏู...${NC}"
    
    # ุฎุงููุงุฏูโุง ฺฉู ุฏุฎุชุฑ ุดุงุบู ุฏุงุฑุฏุ ูุนูููุงู ุงูุชุธุงุฑุงุช ุจุงูุงุชุฑ ุฏุงุฑุฏ
    local expectation_multiplier=$((GIRL_SALARY_LEVEL / 30))
    local effective_threshold=$((FAMILY_THRESHOLD * expectation_multiplier / 2))
    
    if [ $effective_threshold -gt 100 ]; then
        effective_threshold=100
    fi
    
    # ุฏุฎุชุฑ ุดุงุบู ููฺฉู ุงุณุช ุจู ูพุณุฑ ฺฉูโุฏุฑุขูุฏ ุจโูู ูุดุงู ุฏูุฏ
    if [ $boy_financial -lt $GIRL_SALARY_LEVEL ]; then
        local disparity=$((GIRL_SALARY_LEVEL - boy_financial))
        GIRL_INDIFFERENCE=$((GIRL_INDIFFERENCE + (disparity / 5)))
        
        echo -e "${LIGHT_BLUE}   ๐ผ ุฏุฎุชุฑ ุงุฒ ุงุฎุชูุงู ุฏุฑุขูุฏ ูุงุฑุงุถ ุงุณุช${NC}"
        echo -e "${YELLOW}   โณ ยซูู ุฎูุฏู ูโุชููู ุฒูุฏฺฏโุงู ุฑู ุชุฃูู ฺฉููยป${NC}"
    fi
    
    # ูุงุฒ ุดุฏุฏ ูพุณุฑุ ููฺฉู ุงุณุช ุจุงุนุซ ูุฑุงุฑ ุฏุฎุชุฑ ุดูุฏ
    if [ $boy_need -gt 80 ]; then
        echo -e "${LIGHT_BLUE}   ๐ฐ ูุงุฒ ุดุฏุฏ ูพุณุฑุ ุฏุฎุชุฑ ุฑุง ูโุชุฑุณุงูุฏ${NC}"
        echo -e "${YELLOW}   โณ ยซุงุญุณุงุณ ูโฺฉูู ูโุฎูุงุฏ ุงุฒ ูู ูุฑุฏุจุงู ุจุณุงุฒูยป${NC}"
        GIRL_INDIFFERENCE=$((GIRL_INDIFFERENCE + 15))
    fi
    
    # ุชุฃุซุฑ ุชุฑููุงโ ุฑุฏ ุดุฏูโูุง ูุจู
    if [ $REJECTION_TRAUMA -gt 50 ]; then
        echo -e "${PURPLE}   ๐ก ุฏุฎุชุฑ ุจู ุฏูู ุชุฌุฑุจุงุช ูุจู ูุญุชุงุทโุชุฑ ุดุฏู${NC}"
        FAMILY_ATTITUDE=$((FAMILY_ATTITUDE - 10))
    fi
    
    # ุฎุงููุงุฏู ูุบุฑูุฑ
    if [ $FAMILY_PRIDE_LEVEL -gt 70 ]; then
        echo -e "${ORANGE}   ๐ ุบุฑูุฑ ุฎุงููุงุฏู ูุงูุน ุฏุฑฺฉ ูุงุฒ ูพุณุฑ ุงุณุช${NC}"
        echo -e "${YELLOW}   โณ ยซูุง ูุงุฒ ุจู ูพุณุฑ ุดูุง ูุฏุงุฑูยป${NC}"
        FAMILY_DISDAIN=$((FAMILY_DISDAIN + 10))
    fi
    
    # ูุญุฏูุฏ ฺฉุฑุฏู ูุญุฏูุฏูโูุง
    if [ $GIRL_INDIFFERENCE -gt 95 ]; then
        GIRL_INDIFFERENCE=95
    fi
    if [ $FAMILY_ATTITUDE -lt 10 ]; then
        FAMILY_ATTITUDE=10
    fi
}

# ุชุงุจุน ุดุจูโุณุงุฒ ูุงุฒ ูพุณุฑ
simulate_boy_need() {
    local current_financial=$1
    local years_passed=$2
    
    echo ""
    echo -e "${BLUE}๐ญ ูุถุนุช ุฑูุงู ูพุณุฑ...${NC}"
    
    # ูุงุฒ ูพุณุฑ ุชุฑฺฉุจ ุงุฒ ูุงุฒ ุนุงุทู ู ุงูุชุตุงุฏ ุงุณุช
    local emotional_need=$((100 - current_financial))
    local economic_pressure=$(( (100 - current_financial) * 2 / 3 ))
    
    BOY_NEED_LEVEL=$(( (emotional_need + economic_pressure) / 2 ))
    
    # ุจุง ฺฏุฐุดุช ุฒูุงู ู ุนุฏู ูพุงุณุฎุ ูุงุฒ ุงูุฒุงุด ูโุงุจุฏ
    if [ $years_passed -gt 0 ]; then
        BOY_NEED_LEVEL=$((BOY_NEED_LEVEL + (years_passed * 5)))
    fi
    
    # ูุดุงุฑ ุงุฌุชูุงุน
    local social_pressure=$((years_passed * 8))
    BOY_NEED_LEVEL=$((BOY_NEED_LEVEL + social_pressure))
    
    # ุงฺฏุฑ ุฏุฎุชุฑ ุดุงุบู ุจุงุดุฏุ ูุงุฒ ุงูุชุตุงุฏ ุจุดุชุฑ ุงุญุณุงุณ ูโุดูุฏ
    if [ $GIRL_SALARY_LEVEL -gt $current_financial ]; then
        local salary_gap=$((GIRL_SALARY_LEVEL - current_financial))
        BOY_NEED_LEVEL=$((BOY_NEED_LEVEL + (salary_gap / 3)))
        
        echo -e "${BLUE}   ๐ฐ ูพุณุฑ ุงุญุณุงุณ ูโฺฉูุฏ ุจู ูพุดุชุจุงู ุงูุชุตุงุฏ ุฏุฎุชุฑ ูุงุฒ ุฏุงุฑุฏ${NC}"
    fi
    
    # ฺฉุงูุด ุนุฒุช ููุณ ุจุง ุงูุฒุงุด ูุงุฒ
    if [ $BOY_NEED_LEVEL -gt 70 ]; then
        BOY_SELF_ESTEEM=$((BOY_SELF_ESTEEM - (BOY_NEED_LEVEL / 10)))
        echo -e "${RED}   ๐ ูุงุฒ ุดุฏุฏ ุฏุฑ ุญุงู ุชุฎุฑุจ ุนุฒุช ููุณ ูพุณุฑ ุงุณุช${NC}"
    fi
    
    # ูุญุฏูุฏ ฺฉุฑุฏู ูุญุฏูุฏูโูุง
    if [ $BOY_NEED_LEVEL -gt 100 ]; then
        BOY_NEED_LEVEL=100
    fi
    if [ $BOY_SELF_ESTEEM -lt 20 ]; then
        BOY_SELF_ESTEEM=20
    fi
    
    echo -e "${WHITE}   ๐ ูุงุฒ ุชุฑฺฉุจ (ุนุงุทู+ุงูุชุตุงุฏ): ${BOY_NEED_LEVEL}/100${NC}"
    echo -e "${WHITE}   ๐ก ุนุฒุช ููุณ ุจุงูโูุงูุฏู: ${BOY_SELF_ESTEEM}/100${NC}"
}

# ุชุงุจุน ุงุตู ุดุจูโุณุงุฒ
simulate_marriage_process() {
    local years_to_simulate=6
    local current_financial=$BOY_SALARY_LEVEL
    local years_passed=0
    
    echo ""
    echo -e "${CYAN}๐ ุดุฑูุน ูุฑุขูุฏ ุดุจูโุณุงุฒ...${NC}"
    echo -e "${YELLOW}โ ุณูุงุฑู: ุฏุฎุชุฑ ุดุงุบู ุจุง ุฏุฑุขูุฏ ุฎูุจุ ูพุณุฑ ูุงุฒููุฏุ ููุณุงูโูุง ุญุณูุฏ${NC}"
    echo ""
    
    # ุฏุฑุฎูุงุณุช ุงููู
    echo -e "${GREEN}๐จ ูพุณุฑ ุฏุฑุฎูุงุณุช ุงุฒุฏูุงุฌ ูโุฏูุฏ...${NC}"
    sleep 1
    
    if [ $current_financial -lt $FAMILY_THRESHOLD ] || [ $FAMILY_ATTITUDE -lt 50 ]; then
        echo -e "${RED}โ ูพุงุณุฎ ุงููู ุฎุงููุงุฏู: ุจโูู${NC}"
        echo -e "${YELLOW}ยซุจุจูู ฺ ูุดู... ูุนูุงู ููยป${NC}"
        echo ""
        
        # ุณุงูโูุง ุงูุชุธุงุฑ
        for ((year=1; year<=years_to_simulate; year++)); do
            years_passed=$year
            echo -e "${WHITE}โโโโโโโโโโโโโโโโโโโโ ุณุงู ${year} โโโโโโโโโโโโโโโโโโโโ${NC}"
            
            # ูพุดุฑูุช ูุงู ูพุณุฑ
            local financial_growth=$((10 + (RANDOM % 15)))
            current_financial=$((current_financial + financial_growth))
            
            # ูุญุฏูุฏ ฺฉุฑุฏู
            if [ $current_financial -gt 100 ]; then
                current_financial=100
            fi
            
            echo -e "${WHITE}โ  ๐ฐ ูุถุนุช ูุงู ูพุณุฑ: ${current_financial}/100${NC}"
            
            # ุดุจูโุณุงุฒ ูุงุฒ ูพุณุฑ
            simulate_boy_need $current_financial $year
            
            # ุดุจูโุณุงุฒ ุจโูู ุฏุฎุชุฑ ู ุฎุงููุงุฏู
            simulate_indifference $current_financial $BOY_NEED_LEVEL
            
            # ุดุจูโุณุงุฒ ุญุณุงุฏุช ููุณุงฺฏุงู
            simulate_neighbor_jealousy $current_financial
            
            # ุจุฑุฑุณ ุขุง ุดุฑุงุท ูุฑุงูู ุดุฏูุ
            local effective_attitude=$((FAMILY_ATTITUDE - (FAMILY_DISDAIN / 2)))
            
            if [ $current_financial -ge $FAMILY_THRESHOLD ] && [ $effective_attitude -gt 40 ]; then
                echo -e "${WHITE}โ  ${GREEN}โ ุดุฑุงุท ูุงู ูุฑุงูู ุดุฏ!${NC}${WHITE} ุงูุง...${NC}"
                
                if [ $GIRL_INDIFFERENCE -gt 60 ]; then
                    echo -e "${WHITE}โ  ${YELLOW}โ ุฏุฎุชุฑ ูููุฒ ุจโูู ุงุณุช${NC}"
                fi
                
                if [ $FAMILY_DISDAIN -gt 50 ]; then
                    echo -e "${WHITE}โ  ${RED}โ ุฎุงููุงุฏู ูููุฒ ุชุญูุฑ ูโฺฉูุฏ${NC}"
                fi
            fi
            
            echo -e "${WHITE}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
            
            # ุจุฑุฑุณ ุดฺฉุณุช ููุง
            if [ $BOY_SELF_ESTEEM -lt 30 ] && [ $year -gt 2 ]; then
                echo -e "${RED}๐ ูพุณุฑ ุงุฒ ูุญุงุธ ุฑูุงู ุดฺฉุณุช ุฎูุฑุฏู ุงุณุช${NC}"
                break
            fi
            
            if [ $GIRL_INDIFFERENCE -gt 85 ] && [ $FAMILY_ATTITUDE -lt 20 ]; then
                echo -e "${RED}๐ ุฎุงููุงุฏู ู ุฏุฎุชุฑ ฺฉุงููุงู ุจโุนูุงูู ูุณุชูุฏ${NC}"
                break
            fi
            
            sleep 1
        done
        
        return $years_passed
    else
        echo -e "${GREEN}โ ุฏุฑุฎูุงุณุช ุงููู ูพุฐุฑูุชู ุดุฏ!${NC}"
        return 0
    fi
}

# ุชุงุจุน ุชุญูู ููุง
analyze_complex_result() {
    local years_passed=$1
    local final_financial=$2
    
    echo ""
    echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo -e "${PURPLE}                   ๐ ุชุญูู ุนูู ูุชุงุฌ                   ${NC}"
    echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
    echo ""
    
    # ูุญุงุณุจู ุดุงูุณ ููุง
    local final_chance=0
    
    # ุนุงูู ูุงู
    if [ $final_financial -ge $FAMILY_THRESHOLD ]; then
        final_chance=$((final_chance + 40))
    else
        final_chance=$((final_chance - 30))
    fi
    
    # ุนุงูู ูฺฏุฑุด ุฎุงููุงุฏู
    local family_factor=$((FAMILY_ATTITUDE - (FAMILY_DISDAIN / 2)))
    final_chance=$((final_chance + (family_factor / 2)))
    
    # ุนุงูู ุจโูู ุฏุฎุชุฑ
    final_chance=$((final_chance - (GIRL_INDIFFERENCE / 3)))
    
    # ุนุงูู ููุณุงูโูุง ุญุณูุฏ
    local jealousy_impact=$(( (JEALOUS_NEIGHBORS * NEIGHBOR_INTERFERENCE_LEVEL) / 20 ))
    final_chance=$((final_chance - jealousy_impact))
    
    # ุนุงูู ุนุฒุช ููุณ ูพุณุฑ
    if [ $BOY_SELF_ESTEEM -lt 40 ]; then
        final_chance=$((final_chance - 25))
    fi
    
    # ูุญุฏูุฏ ฺฉุฑุฏู ุดุงูุณ
    if [ $final_chance -lt 0 ]; then
        final_chance=0
    elif [ $final_chance -gt 100 ]; then
        final_chance=100
    fi
    
    # ููุงุด ูุชุฌู
    echo -e "${WHITE}๐ ุดุงูุณ ููุง ุงุฒุฏูุงุฌ: ${final_chance}%${NC}"
    echo ""
    
    if [ $final_chance -gt 70 ]; then
        echo -e "${GREEN}โ ุงุญุชูุงู ุงุฒุฏูุงุฌ: ุจุงูุง${NC}"
        echo -e "   โข ูพุณุฑ ุจุง ูุฌูุฏ ููู ููุงูุน ูพุดุฑูุช ฺฉุฑุฏู"
        echo -e "   โข ุงูุง ูุฒูู ุฑูุงู ุฒุงุฏ ูพุฑุฏุงุฎุช ุดุฏู"
        
        if [ $GIRL_INDIFFERENCE -gt 50 ]; then
            echo -e "   ${YELLOW}โ ูุดุฏุงุฑ: ุฑุงุจุทู ููฺฉู ุงุณุช ฺฉุทุฑูู ุจุงุดุฏ${NC}"
        fi
    elif [ $final_chance -gt 40 ]; then
        echo -e "${YELLOW}โ ุงุญุชูุงู ุงุฒุฏูุงุฌ: ูุชูุณุท${NC}"
        echo -e "   โข ููุงูุน ุงุฌุชูุงุน ูููุฒ ูุฌูุฏ ุฏุงุฑูุฏ"
        echo -e "   โข ูุงุฒ ุจู ุชูุงุด ุจุดุชุฑ"
        
        if [ $BOY_NEED_LEVEL -gt 80 ]; then
            echo -e "   ${RED}โ ุฎุทุฑ: ูพุณุฑ ููฺฉู ุงุณุช ุฏฺุงุฑ ูุงุจุณุชฺฏ ูุงุณุงูู ุดูุฏ${NC}"
        fi
    else
        echo -e "${RED}โ ุงุญุชูุงู ุงุฒุฏูุงุฌ: ูพุงู${NC}"
        
        if [ $JEALOUS_NEIGHBORS -gt 2 ] && [ $NEIGHBOR_INTERFERENCE_LEVEL -gt 60 ]; then
            echo -e "   โข ${RED}ููุณุงูโูุง ุญุณูุฏ ููุด ุงุตู ุฏุฑ ุดฺฉุณุช ุฏุงุดุชูุฏ${NC}"
            echo -e "   โข ยซุฏฺฏุฑุงู ูฺฏุฐุงุดุชูุฏ ูุง ุจู ูู ุจุฑุณูยป"
        fi
        
        if [ $GIRL_INDIFFERENCE -gt 70 ]; then
            echo -e "   โข ${PURPLE}ุฏุฎุชุฑ ุดุงุบู ุงุญุณุงุณ ุจุฑุชุฑ ูโฺฉุฑุฏ${NC}"
            echo -e "   โข ูุงุฒ ูพุณุฑ ุฑุง ุฏุฑฺฉ ูฺฉุฑุฏ"
        fi
        
        if [ $FAMILY_DISDAIN -gt 60 ]; then
            echo -e "   โข ${ORANGE}ุบุฑูุฑ ุฎุงููุงุฏู ูุงูุน ุดุฏ${NC}"
            echo -e "   โข ยซูุง ุจุงูุงุชุฑ ุงุฒ ุงู ุญุฑูโูุง ูุณุชูยป"
        fi
        
        if [ $BOY_SELF_ESTEEM -lt 40 ]; then
            echo -e "   โข ${BLUE}ูพุณุฑ ุนุฒุช ููุณ ุฎูุฏ ุฑุง ุงุฒ ุฏุณุช ุฏุงุฏ${NC}"
            echo -e "   โข ุฏฺฏุฑ ุชูุงู ุงุฏุงูู ูุฏุงุฑุฏ"
        fi
    fi
    
    # ุชุญูู ุงุฌุชูุงุน
    echo ""
    echo -e "${CYAN}๐ก ุชุญูู ุงุฌุชูุงุน ุนูู:${NC}"
    echo -e "ยซุงู ุณูุงุฑูุ ฺูุฏ ุขุณุจ ุงุฌุชูุงุน ุฑุง ูุดุงู ูโุฏูุฏ:"
    echo -e ""
    echo -e "1. ${WHITE}ุจโูู ุจู ูุงุฒ ุฏฺฏุฑุงู${NC}: ููุช ฺฉุณ ุฏุฑ ูููุนุช ุจุฑุชุฑ ูุฑุงุฑ ูโฺฏุฑุฏุ"
    echo -e "   ููฺฉู ุงุณุช ูุงุฒูุง ุนุงุทู ุฏฺฏุฑุงู ุฑุง ูุงุฏุฏู ุจฺฏุฑุฏ."
    echo -e ""
    echo -e "2. ${WHITE}ุญุณุงุฏุช ุชุฎุฑุจโฺฏุฑ${NC}: ููุณุงูโูุง ุจู ุฌุง ุฎูุดุญุงู ุจุฑุง ูพุดุฑูุช ุฏฺฏุฑุงูุ"
    echo -e "   ุณุน ูโฺฉููุฏ ูุงูุน ุดููุฏ ุชุง ูุถุนุช ูุณุจ ุฎูุฏ ุฑุง ุญูุธ ฺฉููุฏ."
    echo -e ""
    echo -e "3. ${WHITE}ุบุฑูุฑ ฺฉูุฑฺฉููุฏู${NC}: ุฎุงููุงุฏูโุง ฺฉู ุฏุฎุชุฑ ุดุงุบู ุฏุงุฑุฏุ ููฺฉู ุงุณุช"
    echo -e "   ฺูุงู ุฏุฑ ุบุฑูุฑ ุฎูุฏ ุบุฑู ุดูุฏ ฺฉู ุงูุณุงูุช ุฑุง ูุฑุงููุด ฺฉูุฏ."
    echo -e ""
    echo -e "4. ${WHITE}ุชุจุนุถ ุงูุชุตุงุฏ ุฏุฑ ุนุดู${NC}: ุงุฎุชูุงู ุฏุฑุขูุฏ ุชุจุฏู ุจู ูุงูุน"
    echo -e "   ุจุฑุง ุฏุฑฺฉ ูุชูุงุจู ู ููุฑุงู ูโุดูุฏ.ยป"
    
    # ุฑุงูโุญูโูุง
    echo ""
    echo -e "${GREEN}๐ ุฑุงูฺฉุงุฑูุง ูพุดููุงุฏ:${NC}"
    echo "1. ูพุณุฑ: ุงุจุชุฏุง ุฑู ุนุฒุช ููุณ ู ุงุณุชููุงู ูุงู ฺฉุงุฑ ฺฉูุฏ"
    echo "2. ุฏุฎุชุฑ: ุงุฏ ุจฺฏุฑุฏ ฺฉู ุดุบู ูุจุงุฏ ููุงฺฉ ฺฉุงูู ุงุฑุฒุดโฺฏุฐุงุฑ ุงูุณุงูโูุง ุจุงุดุฏ"
    echo "3. ุฎุงููุงุฏู: ุบุฑูุฑ ฺฉุงุฐุจ ุฑุง ฺฉูุงุฑ ุจฺฏุฐุงุฑูุฏ"
    echo "4. ุฌุงูุนู: ูุฑููฺฏ ุญุณุงุฏุช ุฑุง ุจุง ูุฑููฺฏ ููุฏู ุฌุงฺฏุฒู ฺฉููุฏ"
}

# ุชุงุจุน ุดุฑูุน ุจุฑูุงูู
start_program() {
    show_header
    show_complete_status
    
    echo ""
    echo -e "${RED}โ ุชูุฌู: ุงู ุดุจูโุณุงุฒ ุจุฑ ุงุณุงุณ ุณูุงุฑู ูพฺุฏู ุดูุง ุทุฑุงุญ ุดุฏู${NC}"
    echo -e "${YELLOW}โข ุฏุฎุชุฑ ุดุงุบู ุจุง ุฏุฑุขูุฏ ุฎูุจ${NC}"
    echo -e "${YELLOW}โข ูพุณุฑ ูุงุฒููุฏ (ุนุงุทู/ุงูุชุตุงุฏ)${NC}"
    echo -e "${YELLOW}โข ุฎุงููุงุฏู ูุบุฑูุฑ ู ุจโูู${NC}"
    echo -e "${YELLOW}โข ููุณุงูโูุง ุญุณูุฏ ุจุง ุณุงุจูู ุชุฎุฑุจ${NC}"
    echo -e "${YELLOW}โข ุฎูุงุณุชฺฏุงุฑุงู ุฑุฏุดุฏู ูุจู ฺฉู ุญุงูุง ฺฉูฺฉ ููุณุงูโูุง ูโุขูุฏ${NC}"
    
    echo ""
    read -p "ุขุง ูโุฎูุงูุฏ ุดุจูโุณุงุฒ ุฑุง ุดุฑูุน ฺฉูุฏุ (y/n): " start_choice
    
    if [ "$start_choice" = "y" ] || [ "$start_choice" = "Y" ]; then
        simulate_marriage_process
        local years_result=$?
        
        analyze_complex_result $years_result $BOY_SALARY_LEVEL
        
        echo ""
        echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
        echo -e "${PURPLE}                     ูพุงุงู ุดุจูโุณุงุฒ                     ${NC}"
        echo -e "${CYAN}โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ${NC}"
        
        # ุฐุฎุฑู ูุชุงุฌ ุฏุฑ ูุงู
        save_results $years_result
    else
        echo -e "${YELLOW}ุดุจูโุณุงุฒ ูุบู ุดุฏ.${NC}"
    fi
}

# ุชุงุจุน ุฐุฎุฑู ูุชุงุฌ
save_results() {
    local years=$1
    local timestamp=$(date "+%Y-%m-%d %H:%M:%S")
    
    cat > "marriage_simulation_result_$(date +%s).txt" << EOF
ูุชุงุฌ ุดุจูโุณุงุฒ ูพฺุฏู ุงุฒุฏูุงุฌ ููุณุงูโุง
ุชุงุฑุฎ: $timestamp
ูุฏุช ุดุจูโุณุงุฒ: $years ุณุงู

=== ูุดุฎุตุงุช ุงูุฑุงุฏ ===
ูพุณุฑ: $BOY_NAME
ุฏุฎุชุฑ: $GIRL_NAME ($GIRL_OCCUPATION)

=== ูุถุนุช ููุง ===
ุฏุฑุขูุฏ ูพุณุฑ: $BOY_SALARY_LEVEL/100
ุฏุฑุขูุฏ ุฏุฎุชุฑ: $GIRL_SALARY_LEVEL/100
ูุงุฒ ูพุณุฑ: $BOY_NEED_LEVEL/100
ุจโูู ุฏุฎุชุฑ: $GIRL_INDIFFERENCE/100
ุนุฒุช ููุณ ูพุณุฑ: $BOY_SELF_ESTEEM/100

=== ุนูุงูู ุงุฌุชูุงุน ===
ููุณุงูโูุง ุญุณูุฏ: $JEALOUS_NEIGHBORS ููุฑ
ุณุทุญ ุฏุฎุงูุช: $NEIGHBOR_INTERFERENCE_LEVEL/100
ุฎูุงุณุชฺฏุงุฑุงู ุฑุฏุดุฏู ูุจู: $PREVIOUS_REJECTED_SUITORS ููุฑ
ุบุฑูุฑ ุฎุงููุงุฏู: $FAMILY_PRIDE_LEVEL/100
ุชุญูุฑ ุฎุงููุงุฏู: $FAMILY_DISDAIN/100

=== ุชุญูู ===
ุณูุงุฑู ุดุจูโุณุงุฒ ุดุฏู ูุดุงูโุฏููุฏู ูุดฺฉูุงุช ุนูู ุงุฌุชูุงุน ุงุณุช:
1. ุจโูู ูุณุจุช ุจู ูุงุฒ ุฏฺฏุฑุงู ุฏุฑ ูููุนุชโูุง ุจุฑุชุฑ
2. ุญุณุงุฏุช ุงุฌุชูุงุน ุชุฎุฑุจโฺฏุฑ
3. ุบุฑูุฑ ฺฉูุฑฺฉููุฏู ูุงุด ุงุฒ ููููุช ุงูุชุตุงุฏ
4. ูุงุชูุงู ุฏุฑ ุฏุฑฺฉ ูุงุฒูุง ุนุงุทู ุฏฺฏุฑุงู

ุงู ุณุณุชู ุงุฌุชูุงุน ูุงุฒููุฏ ุจุงุฒูฺฏุฑ ุฏุฑ ุงุฑุฒุดโูุง ู
ุฌุงฺฏุฒู ุญุณุงุฏุช ุจุง ููุฏู ุงุณุช.
EOF
    
    echo -e "${GREEN}โ ูุชุงุฌ ุฏุฑ ูุงู ุฐุฎุฑู ุดุฏ.${NC}"
}

# ==================== ุดุฑูุน ุจุฑูุงูู ====================
start_program

# ููู ุชุนุงูู
echo ""
echo -e "${WHITE}ฺฏุฒููโูุง ุจุดุชุฑ:${NC}"
echo "1) ุงุฌุฑุง ูุฌุฏุฏ ุจุง ูพุงุฑุงูุชุฑูุง ูุชูุงูุช"
echo "2) ูุดุงูุฏู ูุงู ูุชุงุฌ"
echo "3) ุฎุฑูุฌ"
echo ""
echo -n "ุงูุชุฎุงุจ ุดูุง: "
read final_choice

case $final_choice in
    1)
        # ุจุงุฒูุดุงู ุจุฑุฎ ูพุงุฑุงูุชุฑูุง
        BOY_SALARY_LEVEL=$((30 + (RANDOM % 30)))
        GIRL_INDIFFERENCE=$((40 + (RANDOM % 40)))
        BOY_SELF_ESTEEM=$((50 + (RANDOM % 40)))
        JEALOUS_NEIGHBORS=$((1 + (RANDOM % 5)))
        
        echo -e "${GREEN}๐ ูพุงุฑุงูุชุฑูุง ุจุงุฒูุดุงู ุดุฏูุฏ. ุงุฌุฑุง ูุฌุฏุฏ...${NC}"
        sleep 2
        exec "$0"
        ;;
    2)
        echo -e "${YELLOW}๐ ูุญุชูุง ูุงู ูุชุงุฌ:${NC}"
        echo ""
        cat marriage_simulation_result_*.txt 2>/dev/null || echo "ูุงู ุงูุช ูุดุฏ."
        ;;
    3)
        echo -e "${CYAN}ุจุง ุขุฑุฒู ุฌุงูุนูโุง ุจุง ููุฏู ุจุดุชุฑ...${NC}"
        exit 0
        ;;
esac