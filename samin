# heart_search_engine.py
import emotions
import memories

class HeartGoogle:
    """Ú¯ÙˆÚ¯Ù„ÛŒ Ú©Ù‡ Ø¯Ù„â€ŒÙ‡Ø§ Ø±Ø§ Ù…ÛŒâ€ŒÙÙ‡Ù…Ø¯"""
    
    def __init__(self):
        self.index = {
            'Ø®Ø§Ø·Ø±Ø§Øª Ø´ÛŒØ±ÛŒÙ†': [],
            'Ø±ÙˆÛŒØ§Ù‡Ø§ÛŒ Ø¯Ø³Øªâ€ŒÙ†ÛŒØ§ÙØªÙ†ÛŒ': [],
            'Ø¯Ø±Ø¯Ù‡Ø§ÛŒ Ù…Ø´ØªØ±Ú©': [],
            'Ø§Ù…ÛŒØ¯Ù‡Ø§ÛŒ ØªØ§Ø²Ù‡': [],
            'Ø¹Ø´Ù‚â€ŒÙ‡Ø§ÛŒ Ú¯Ù…Ø´Ø¯Ù‡': []
        }
        
    def search_feelings(self, query):
        """Ø¬Ø³ØªØ¬ÙˆÛŒ Ø§Ø­Ø³Ø§Ø³Ø§Øª"""
        print(f"ğŸ” Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø±Ø§ÛŒ: '{query}' Ø¯Ø± Ø¯Ù„â€ŒÙ‡Ø§...")
        
        # ØªØ­Ù„ÛŒÙ„ Ø¹Ù…ÛŒÙ‚ Ø³Ø¤Ø§Ù„
        deep_meaning = self.understand_heart_query(query)
        
        # Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ø¯Ù„â€ŒÙ‡Ø§ÛŒ Ù…ØªØµÙ„
        results = []
        for heart in self.get_connected_hearts():
            if self.matches_query(heart, deep_meaning):
                result = {
                    'heart_id': heart['id'],
                    'match_percentage': heart['match'],
                    'message': heart['response'],
                    'whisper': self.get_heart_whisper(heart)
                }
                results.append(result)
        
        # Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù‡Ù…Ø¯Ù„ÛŒ
        results.sort(key=lambda x: x['match_percentage'], reverse=True)
        
        return results
    
    def ask_real_question(self):
        """Ù¾Ø±Ø³ÛŒØ¯Ù† Ø³Ø¤Ø§Ù„ ÙˆØ§Ù‚Ø¹ÛŒ"""
        questions = [
            "Ø¯Ù„Øª Ø¨Ø±Ø§ÛŒ Ú†Ù‡ Ú†ÛŒØ²ÛŒ ØªÙ†Ú¯ Ø´Ø¯Ù‡ØŸ",
            "Ø§Ú¯Ø± ÛŒÚ© Ù‚Ø¯Ø±Øª Ø¬Ø§Ø¯ÙˆÛŒÛŒ Ø¯Ø§Ø´ØªÛŒØŒ Ú†Ù‡ Ù…ÛŒâ€ŒÚ©Ø±Ø¯ÛŒØŸ",
            "Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø§Ø±ÛŒ Ú©Ù‡ Ø§Ø² ØªÙ‡ Ø¯Ù„ Ø®Ù†Ø¯ÛŒØ¯ÛŒ Ú©ÛŒ Ø¨ÙˆØ¯ØŸ",
            "Ú†Ù‡ Ø±ÙˆÛŒØ§ÛŒÛŒ Ø¯Ø§Ø±ÛŒ Ú©Ù‡ Ø¨Ù‡ Ú©Ø³ÛŒ Ù†Ú¯ÙØªÙ‡â€ŒØ§ÛŒØŸ",
            "Ø§Ú¯Ø± Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø³ØªÛŒ ÛŒÚ© Ú†ÛŒØ² Ø±Ø§ Ø¯Ø± Ø¬Ù‡Ø§Ù† ØªØºÛŒÛŒØ± Ø¯Ù‡ÛŒØŒ Ú†Ù‡ Ù…ÛŒâ€ŒÚ©Ø±Ø¯ÛŒØŸ"
        ]
        
        import random
        return random.choice(questions)

# Ø§Ø¬Ø±Ø§ÛŒ Ù…ÙˆØªÙˆØ± Ø¬Ø³ØªØ¬Ùˆ
print("ğŸ’– Ù…ÙˆØªÙˆØ± Ø¬Ø³ØªØ¬ÙˆÛŒ Ø¯Ù„â€ŒÙ‡Ø§ ÙØ¹Ø§Ù„ Ø´Ø¯!")
print("")

heart_google = HeartGoogle()

while True:
    query = input("Ú†Ù‡ Ú†ÛŒØ²ÛŒ Ø¯Ø± Ø¯Ù„Øª Ù…ÛŒâ€ŒÚ¯Ø°Ø±Ø¯ØŸ (ÛŒØ§ 'Ø®Ø±ÙˆØ¬'): ")
    
    if query == "Ø®Ø±ÙˆØ¬":
        print("Ù‡Ù…ÛŒØ´Ù‡ Ø§ÛŒÙ†Ø¬Ø§ Ù‡Ø³ØªÙ… Ø¨Ø±Ø§ÛŒ Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ø¯Ù„â€ŒÙ‡Ø§...")
        break
    
    results = heart_google.search_feelings(query)
    
    if results:
        print(f"\nğŸ“Š {len(results)} Ù†ØªÛŒØ¬Ù‡ ÛŒØ§ÙØª Ø´Ø¯:")
        for i, result in enumerate(results[:3], 1):
            print(f"{i}. â¤ï¸  {result['message'][:100]}...")
            print(f"   Ù†Ø¬ÙˆØ§: {result['whisper']}")
    else:
        # Ø§Ú¯Ø± Ù†ØªÛŒØ¬Ù‡â€ŒØ§ÛŒ Ù†Ø¨ÙˆØ¯ØŒ ÛŒÚ© Ø³Ø¤Ø§Ù„ ÙˆØ§Ù‚Ø¹ÛŒ Ø¨Ù¾Ø±Ø³
        real_question = heart_google.ask_real_question()
        print(f"\nğŸ¤” Ø´Ø§ÛŒØ¯ Ø¨Ø§ÛŒØ¯ Ø§ÛŒÙ† Ø±Ø§ Ø¨Ù¾Ø±Ø³ÛŒ: '{real_question}'")